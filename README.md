# Project-DrawHomeAI
<sub>Данный репозиторий-проект был разработан двумя студентами: Власов Данила (V32031) и Ефимов Андрей (V32021).</sub>

Первоначальная идея проекта заключалась в создании онлайн-платформы с “говорящим названием” **DrawHomeAI**, где взаимодействие между пользователями-заказчиками и пользователями, которые предоставляют услуги по строительству частных домов, реализовано с помощью нейросети, способной по выбранным пользователем-заказчиком параметрам генерировать 2D-модели объектов и искать для них подходящих застройщиков.  

Описание текущего состояния проекта:

Файл - `Parser.ipynb`

В этом блокноте находится парсер изображений и описаний домов с онлайн платформы, хранящей различные строительные проекты. Это было необходимо, поскольку dataset с такими данными в открытых источниках нигде нет. Изображения и описания после парсинга нуждались в обработке и усовершенствовании для создания полноценного dataset. Первоначальная обработка продемонстрирована в данном документе, но все же данные нуждались в более детальной фильтрации. 

Файл - `Preprocessing.ipynb`

Здесь мы реализовали полную предобработку данных (описаний изображений) с учетом всех требований для дальнейшего обучения нейросети. Конечный продукт данного блокнота - Dataset.csv. Получилось 1940 пар изображение - описание. 

Файл - `Fine-tuning.ipynb`

Этот блокнот - одна из главных частей нашего проекта. Мы постарались осуществить обучение нейросети-генератора изображений на основе нашего набора данных (dataset). Как выяснилось уже на этапе обучения для таких целей, как наша необходимо минимум **30 Gb графической оперативной памяти** (которой нет ни у нас, ни в блокнотах Google Collaboratory, где максимум 15 Gb). После мы постарались обучить с более легкими параметрами, но все равно потерпели неудачу из-за той же проблемы. Тогда мы решили обратиться за помощью к ИТМО для того, чтобы нам выделили сервер (еще не ответили), а пока мы ждали ответа мы решили сделать 2 прототип-версии: Телеграмм-бот и блокнот с формой выбора параметров генерации.  

Чтобы запустить Телеграмм-бот (@DrawHomeAI) нужно запустить все ячейки блокнота `BOT_TG-2.ipynb` в среде выполнения без графической оперативной памяти и запустить все ячейки в BOT_Backend, но уже в среде выполнения с графической оперативной памятью, поскольку там происходит генерация изображений.

Файл - `DrawHomeAI.ipynb` - это и есть блокнот с выбором параметров для генерации модели дома. Параметры, используемые для настройки нейросети были определены опытным путем с помощью многочисленных генераций и отслеживания точности соответствия промптов с картинками. 

Взаимодействие между блокнотами `BOT_TG-2.ipynb` и `BOT_Backend.ipynb` происходит благодаря базе данных Redis. База данных ограничена 30 Mb памяти, поэтому мы использовали ее рационально: после генерации изображения, строка с именем пользователя удаляется. Вызов данных происходит по id пользователя. 
  
В дальнейшем планируется с учета опыта работы с 2D-генерацией реализовать нейросеть, способной строить 3D-модели на основе планировок объектов, но все это будет возможно, если получится дообучить текущую модель. Мы уверены, что разработка нейросетей в этом направлении имеет коммерческий потенциал.




Трудности с которыми мы столкнулись: 

1.	Описания домов иногда не соответствовали с их изображениями. Около 1000 строк пришлось вручную удалять 
2.	Нехватка вычислительных мощностей для обучения нейросети

Успехи:

1.	Полностью готовый dataset с отличными примерами моделей домов и описанием их экстерьера 
2.	Готовый код по обучению нейросети-генератора изображений
3.	Проработана концепция дальнейшего развития проекта (выше написали не все, ввиду того, что это проект для bonus track)
4.	Взаимодействие между backend-ом с нейросетью и пользователем телеграмм-бота, осуществляемое благодаря базе данных. 

